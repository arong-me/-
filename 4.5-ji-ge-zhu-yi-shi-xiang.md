# 4.5　几个注意事项

###  1. 4.5　几个注意事项 <a id="4_5&#x3000;&#x51E0;&#x4E2A;&#x6CE8;&#x610F;&#x4E8B;&#x9879;"></a>

#### 1.1. 4.5.1　数据建模不是孤立的 <a id="4_5_1&#x3000;&#x6570;&#x636E;&#x5EFA;&#x6A21;&#x4E0D;&#x662F;&#x5B64;&#x7ACB;&#x7684;"></a>

前面已经说过，软件设计包括数据库设计、功能设计、界面设计三大项工作，虽然为了讲解的方便，本书将之分开阐述，但要知道，在实际工作中，这三者往往是交错进行、相互影响的。

数据模型是静的，但数据却是动的，处于不停的流动过程中，会从这个表流动到另外一个表，会从数据库中流动到用户界面，不同的功能逻辑，不同的界面操作方式，都会对数据模型产生不同的要求。

**案例：功能逻辑方案影响数据模型**

某软件系统有个“删除部门”的功能。由于部门下可能会存在员工，如果把部门删除了，部门的员工怎么办呢？因此，要求在删除部门时有个逻辑判断，如果该部门下包括员工，则不允许删除。可以考虑以下两种方案来处理这件事。

方案一：在删除部门时，在员工表中检索，如果存在属于本部门的员工，则不允许删除，否则允许删除。这个方案的优点是数据模型简单，缺点是不利于扩展，哪一天有别的表（如岗位）需要关联部门，那么这个“删除部门”的功能是不是需要跟着修改呢？并且，只要有新的表需要关联部门，那么这个“删除部门”的功能是不是需要永远跟着修改下去呢？

方案二：在部门表中增加一个字段“允许删除标志”，当新增员工时，如果员工关联了某个部门（所属部门不为空），则将该部门的“允许删除标志”设为“N”。当删除部门时，不看别的，就看这个标志，如果为“N”则不允许删除。这个方案的优点是容易扩展，如果有别的表需要关联部门，只要同样在这个字段打上标志就行了；缺点是需要新增字段，新增员工时需要同时写这个标志，涉及对两个表的事务处理，增加了性能开销。

不同的方案，对数据模型的要求并不一样，方案一不需要在“部门”表中额外增加字段，方案二需要，如图4-20所示。

![](http://b.7dtime.com/B01N1216C4/images/00046.jpeg)

图4-20　功能逻辑方案影响数据模型

#### 1.2. 4.5.2　注意可扩展性 <a id="4_5_2&#x3000;&#x6CE8;&#x610F;&#x53EF;&#x6269;&#x5C55;&#x6027;"></a>

客户的业务在发展，人员在变化，管理在变化，技术在变化，对于管理软件的需求自然也会不断变化，需求的变化自然会带来对软件的变更要求。对于软件开发者来说，最痛苦的事情莫过于变更数据模型了。为了应对未来可能的需求变更与追加，在数据建模阶段，就应该尽量多做这方面的考虑，努力将数据库设计得更有柔性，更容易扩展功能。

**案例：增加数据库的可扩展性**

小王在进行某学校管理系统的数据建模工作，正在考虑教师跟班级这两个实体的关系。根据业务需求，一个班级有一个辅导员，一个辅导员可以带多个班级，显然，教师跟班级这两个实体的关系是一对多的关系。如果采用一对多的关系来处理，完全可以满足当前的业务需求。但是，小王考虑到，未来也许会发生一个班级安排多个辅导员的情况，如果现在采用一对多的关系来处理，这种情况一旦发生，数据库结构需要巨大变更，那就太痛苦了。小王决定采用多对多的关系来处理，增加一个“辅导员”表，保存辅导员的带班信息，至于当前一个班级只有一个辅导员的需求，只需要在界面或者功能逻辑中做些控制就可以了，现在需要增加一点儿工作量，但为了未来的可扩展性，小王觉得还是值得的，如图4-21所示。

![](http://b.7dtime.com/B01N1216C4/images/00047.jpeg)

图4-21　教师与班级的关系的处理

#### 1.3. 4.5.3　不要教条主义 <a id="4_5_3&#x3000;&#x4E0D;&#x8981;&#x6559;&#x6761;&#x4E3B;&#x4E49;"></a>

在进行数据建模工作时，需要把握好基础理论知识，但又要注意不能囿于这些所谓的原理、规范、文档格式等，要灵活运用，不要教条主义，关键是要锳出一条适合自己、适合项目、适合团队的路子，合适的才是好的。

例如，我们说数据建模要遵守这范式那范式，不能有冗余数据，但也要明白，范式只是范式，没有必要纠结第一范式第二范式第三范式第N范式，只要明白一个道理：尽量避免数据冗余，因为冗余数据容易产生异常。什么时候会产生冗余数据，在实际工作中很容易从数据库结构中悟到，往往倒是要弄明白究竟违反了哪个范式有些麻烦。

数据库中未必不能有数据冗余，有的时候，为了提高检索效率，是可以考虑存储冗余数据的，只不过，作为数据建模者，要有清醒的意识，至少要考虑到以下这几点。

（1）这里会产生数据冗余吗？

（2）如果会产生冗余，为什么要这个冗余？

（3）需要保持这些冗余数据的一致性吗？如果需要，怎么保持？

#### 1.4. 4.5.4　不要经验主义 <a id="4_5_4&#x3000;&#x4E0D;&#x8981;&#x7ECF;&#x9A8C;&#x4E3B;&#x4E49;"></a>

从事需求分析或软件设计工作有一定年限后，必然会积累一些经验，从而可以大大提高工作效率，对软件未来的发展、变更有较强的预判能力，但经验多了之后就得注意不要犯经验主义的错误。因为经验丰富了，就觉得自己见过的、处理过的情况很多，走过的桥比别人走过的路还多，认为用户的需求基本都在自己的掌控范围之内，从而忽视了对用户所提需求的真正尊重，最终导致软件严重偏离用户的工作要求，不得不进行大修大补，造成不必要的损失。

**案例：数据建模不要犯经验主义**

小王在某公司进行组织架构的调研，根据自己的经验，部门与员工之间的关系应该是一对多的关系，一个部门有多个员工，一个员工只能属于一个部门，于是就觉得这个并不需要过多考虑。然而，事情并没有想象的那么简单，这个企业里有很多兼职的情况，如甲车间主任兼后勤部副部长，行政部经理兼工会主席等。数据建模时，部门与员工的关系被确定为一对多的关系，软件投入使用后才发现，这个关系应该是多对多的关系，这可怎么办呢？小王陷入了苦恼之中。

